# チュートリアルゲーム開発計画

## プロジェクト概要

`examples/tutorial`ディレクトリにて、tsuzuriノベルゲームエンジンの使い方を解説するチュートリアルゲームを実装します。

### 参考実装

- `examples/shopping`: 既存のサンプルゲーム（実装パターンの参考）
- `packages/core`: ゲームエンジン本体
- `packages/driver`: Reactコンポーネントと永続化機能

## シナリオ構成

`scenario.md`に記載された3章構成：

1. **イントロ**: ずんだもんがノベルゲームを作りたいと宣言
2. **tsuzuriとは**: エンジンの技術解説（Elm Architectureの説明）
3. **おわり**: メタオチ（このチュートリアル自体がノベルゲーム）

## デザイン方針

### ターゲット

エンジニア・開発者向けの技術解説を含むコミカルなチュートリアル

### デザインの基本方針

**1. 読みやすさ最優先**

- 技術解説が含まれるため、テキストの可読性を重視
- 背景は淡い色で、テキストとのコントラストを確保
- フォントサイズは十分に大きく（16px以上）

**2. キャラクター性を活かす**

- ずんだもん・めたんのポップな雰囲気を保つ
- 吹き出しはキャラクターのイメージカラーを使用（ずんだもん：緑系、めたん：ピンク系）
- コミカルな演出とシリアスな解説のメリハリをつける

**3. UIは控えめに**

- セーブ・ロードなどのボタンは半透明で配置
- ゲーム進行の邪魔にならないよう、右下隅に配置
- ホバー時のみ不透明にして存在を主張

### 章ごとのUIモード

**イントロ・おわり（吹き出しモード）**

- キャラクター立ち絵 + 吹き出し形式
- 背景は生活感のある場所
- ボタン類は画面右下に配置

**tsuzuriとは（テキストボックスモード）**

- 画面下部に半透明のテキストボックス
- キャラクター名をボックス左側に表示
- 技術図解（Elmロゴ、アーキテクチャ図）を画面中央に配置可能
- 落ち着いた背景で図解を邪魔しない

### 配色

- **背景**: 淡いグラデーション（ピンク〜紫〜青など）
- **テキストボックス**: 半透明の白（rgba(255, 255, 255, 0.9)）
- **吹き出し**: キャラクターごと（ずんだもん：薄緑、めたん：薄ピンク）
- **ボタン**: グレー系、ホバー時に色を強調

## アセット状況

### 利用可能

- キャラクター立ち絵（ずんだもん・めたん、各種表情）
- BGM 4曲
- SE 多数
- ボイス（ずんだもん23ファイル、めたん15ファイル）
- Elm関連画像（ロゴ、アーキテクチャ図）

### 不足（プレースホルダーで対応）

以下の画像が必要ですが、テキストラベル付きのダミー画像で代用します：

- リビング背景
- ソースコード画像
- ゲーム画面例（3種類）
- KAGタグ例
- シナリオ管理コード例

## 必要な機能

### 基本機能

- **セーブ・ロード**: スロット選択式、日時とテキストプレビュー表示
- **ログ表示**: 過去の会話を最大50件表示
- **設定**: BGM音量・SE音量・テキスト速度の調整（localStorageに保存）
- **スキップボタン**: UI配置のみ（機能は今後実装）
- **クレジット**: エンディング後に表示

## 実装の流れ

### 1. プロジェクトセットアップ

```bash
cd examples/tutorial
mkdir -p src/{pages,components,game,hooks,types}
mkdir -p src/assets/images/{backgrounds,placeholders}
```

### 2. ルーティング実装

`src/App.tsx`にて状態ベースのルーティングを実装（`examples/shopping`を参考）

ページ:

- AudioConfirmPage（音声許可確認）
- TitlePage（タイトル画面）
- GamePage（ゲーム本編）
- SavePage・LoadPage（セーブ・ロード）
- LogPage（会話ログ）※新規作成
- ConfigPage（設定）※新規作成

### 3. 設定の永続化

`src/hooks/useConfig.ts`を作成し、localStorageと同期する設定管理フックを実装

```typescript
interface GameConfig {
  bgmVolume: number;
  seVolume: number;
  textSpeed: number;
}
```

### 4. シナリオ実装

`src/game/scenario.ts`にて、`scenario.md`の内容をNovelMessageの配列として実装

ヘルパー関数（`src/game/helpers.ts`）:

- `showSpeechBubble()`: 吹き出し表示
- `showDialog()`: テキストボックスに表示
- `showCharacter()`: キャラクター立ち絵表示
- `changeBackground()`: 背景変更

### 5. 統合とテスト

- 全ページの動作確認
- セーブ・ロードの検証
- 音声・BGMの再生確認
- 設定の永続化確認

## 技術的なポイント

### エンジンAPI

主要なメッセージ:

- `sequence([...])`: メッセージを順次実行
- `awaitAction()`: クリック待機
- `addWidgets([...])`: ウィジェット追加
- `addTextBox()`, `addText()`: テキスト表示
- `addTrack()`, `playChannel()`: 音声再生
- `switchScenario()`: シナリオ切り替え

ウィジェットビルダー（`w.`）:

- `w.layout()`: レイアウトコンテナ
- `w.img()`: 画像
- `w.button()`: ボタン

### スタイリング

Tailwind CSSを使用（`examples/shopping`で既に設定済み）

### アニメーション

CSS animationクラスまたはcoreの`AnimationTicket`を使用

## 開発時間見積もり

- セットアップ・プレースホルダー作成: 2-3時間
- ルーティングとページ実装: 8-10時間
- シナリオ実装: 10-12時間
- 統合・テスト: 4-6時間

**合計**: 約25-30時間

## 完了条件

- [ ] 3章すべてが最初から最後まで再生できる
- [ ] セーブ・ロードが正しく動作する
- [ ] ログに過去の会話が表示される
- [ ] 設定がlocalStorageに保存される
- [ ] BGM・SE・ボイスが正しいタイミングで再生される
- [ ] キャラクター立ち絵と背景が表示される
- [ ] クレジットが表示される
- [ ] ブラウザコンソールにエラーがない

## 参考資料

- `examples/shopping/`: 完全な実装例
- `packages/core/README.md`: エンジンAPI
- `scenario.md`: シナリオ仕様
